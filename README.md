# Franklin Debt Advisor

An interactive web application that allows users to ask Benjamin Franklin questions about the U.S. national debt. The application uses GPT-4 to generate responses in Franklin's voice, ElevenLabs to convert the text to speech, and D-ID to animate a portrait of Benjamin Franklin.

## Features

- Ask questions about the U.S. national debt
- Get responses from Benjamin Franklin with accurate facts
- See and hear an animated Benjamin Franklin delivering the response
- Real-time progress updates during processing

## Tech Stack

- React/Next.js for the frontend and API routes
- OpenAI GPT-4 for generating Franklin's responses
- ElevenLabs for text-to-speech generation
- D-ID for avatar animation
- Cloudinary for audio file storage
- Socket.io for real-time progress updates

## Setup

1. Clone the repository
2. Install dependencies:
   ```
   npm install
   ```
3. Create a `.env.local` file with the following variables:
   ```
   OPENAI_API_KEY=your_openai_api_key
   ELEVENLABS_API_KEY=your_elevenlabs_api_key
   ELEVENLABS_VOICE_ID=your_custom_ben_franklin_voice_id
   DID_API_KEY=your_did_api_key
   BEN_FRANKLIN_IMAGE_URL=https://your-bucket.com/benjamin-franklin.jpg
   CLOUDINARY_CLOUD_NAME=your_cloud_name
   CLOUDINARY_API_KEY=your_api_key
   CLOUDINARY_API_SECRET=your_api_secret
   FAKE_DEMO_MODE=false
   ```
4. Start the development server:
   ```
   npm run dev
   ```
5. For testing without API keys, you can enable demo mode:
   ```
   FAKE_DEMO_MODE=true
   ```

## API Implementation Notes

### Cloudinary Setup

This project uses Cloudinary for storing audio files that are generated by ElevenLabs before they are sent to D-ID. To set up Cloudinary:

1. Create a free Cloudinary account at [cloudinary.com](https://cloudinary.com)
2. Get your account details from the dashboard (Cloud name, API Key, API Secret)
3. Add these to your environment variables

### API Sequence

The application follows this sequence of API calls:

1. OpenAI GPT-4: Generates Franklin's response to the user's question
2. ElevenLabs: Converts the text response to speech with Franklin's voice
3. Cloudinary: Stores the audio file and provides a public URL
4. D-ID: Animates the Franklin portrait to speak using the audio URL

### Diagnostic Tools

The application includes several diagnostic features to help with troubleshooting:

- `/api/debug` endpoint: Tests all API connections and reports status
- `/debug` page: User-friendly interface for diagnosing API issues
- In-browser console logs with detailed error information
- Status tracking for request processing stages

## Troubleshooting

### Common Issues

1. **"Failed to process your question" error**:
   - Check that all environment variables are correctly set
   - Verify API keys are valid and not expired
   - Visit `/debug` page to run API diagnostics

2. **404 Error on API Endpoints**:
   - Make sure the application is properly deployed
   - Check that routes are correctly configured
   - Verify that all Next.js API handlers are exported correctly

3. **Authentication Errors**:
   - Double-check your API keys in environment variables
   - Ensure your D-ID API key is properly encoded
   - Verify ElevenLabs voice ID exists in your account

4. **Missing Audio/Video**:
   - Check that your BEN_FRANKLIN_IMAGE_URL is publicly accessible
   - Verify Cloudinary configuration is correct
   - Ensure file formats are supported (mp3 for audio, jpg/png for image)

### State Management

The application uses in-memory state management which works well for development and lightweight production scenarios. For high-traffic applications, you should:

1. Implement a proper database (MongoDB, PostgreSQL, etc.)
2. Use a message queue for processing (AWS SQS, RabbitMQ, etc.)
3. Consider serverless database options for Vercel deployment

## Deployment

You can deploy this application to Vercel:

1. Push your code to GitHub
2. Connect your repository to Vercel
3. Configure all environment variables in Vercel project settings
4. Deploy the application

## License

MIT
